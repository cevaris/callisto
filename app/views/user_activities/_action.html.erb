<div class="btn-group">
	<% if @user and @user.id == @user_activity.user.id %>

		<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
			<% if @user_activity.state == UserActivity::ACCEPTED %>
				<i class="icon-ok"></i> Accpeted 
			<% elsif @user_activity.state == UserActivity::COMPLETED %>
				<i class="icon-ok"></i> Completed
			<% elsif @user_activity.state == UserActivity::FORFEITED %>
				<i class="icon-ok"></i> Forfeited
			<% end %>
			<span class="caret"></span>
		</a>
		<ul class="dropdown-menu">
			<li><%= link_to 'Accept',   user_user_activity_accept_path(@user_activity.user,@user_activity),    :remote => true, class: 'user-activity-select' %></li>
		  <li><%= link_to 'Complete', user_user_activity_complete_path(@user_activity.user, @user_activity), :remote => true, class: 'user-activity-select' %></li>
		  <li><%= link_to 'Forfeit',  user_user_activity_forfeit_path(@user_activity.user,@user_activity),   :remote => true, class: 'user-activity-select' %></li>
		</ul>
	<% else %>

		<a class="btn" href="javascript:void(0);">
			<% if @user_activity.state == UserActivity::ACCEPTED %>
				<i class="icon-ok"></i> Accpeted 
			<% elsif @user_activity.state == UserActivity::COMPLETED %>
				<i class="icon-ok"></i> Completed
			<% elsif @user_activity.state == UserActivity::FORFEITED %>
				<i class="icon-ok"></i> Forfeited
			<% end %>
		</a>
	<% end %>
</div>

<script type="text/javascript">

$(document).ready(function() { 

	$(document)
	.on('ajax:success', '.user-activity-select', function(event, data, status, xhf) {
		$('.activity-actions').html(data);
	});	

	$(document)
	.on('ajax:error', '.user-activity-select', function(event, data, status, xhf) {
		pushFlash({message:'Error selecting activity action.', state: 'error', fadeOut: 5000});
	});
});
</script>