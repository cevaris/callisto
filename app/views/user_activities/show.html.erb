<%= hidden_field_tag 'activity-id', @activity.id %>
<%= hidden_field_tag 'user-activity-id', @user_activity.id %>



<div class="row" >

	<div class="span3" >
		<%= render partial: '/users/user', locals: { user: @user_activity.user } %>
	</div><!-- user -->


	<div class="span9">

		<div class="row">
			<div class="span9">
			<span class="pull-right" >
				<span class="activity-actions">
					<%= render 'action'%>
				</span>
				<span>
				<% if @current_user and ((@current_user.id == @user_activity.user.id) or (@current_user.role == User::SUPER_ADMIN)) %>
					<span>
						<div class="btn-group" data-toggle="buttons-radio">
						  <button id="select_public" type="button" class="btn  <%= active_privacy_public(@user_activity)  %>"><i class="icon-globe"> Public</i></button>
						  <button id="select_friends" type="button" class="btn <%= active_privacy_friends(@user_activity) %>"><i class="icon-group"> Friends</i></button>
						  <button id="select_only_me" type="button" class="btn <%= active_privacy_only_me(@user_activity) %>"><i class="icon-male"> Only Me</i></button>
						</div>
					</span>
					<span>
						<%= link_to 'Update', edit_user_user_activity_path(@user_activity.user, @user_activity), class: 'btn' %>
					</span>
				<% end %>
				</span
			</span>	
		</div>
		</div>

		<div class="row">
			<div class="span9">
				<div class="text-left">
					<h1><%= link_to @activity.name, activity_path(@activity) %></h1>
					<span  class="text-left">
						<b><%= @activity.tag_list %></b>
					</span>
				</div>
			</div>
		</div>
				
		<hr/>

		<div class="row">
			<div class="span9">
		
				<label><b>Description:</b></label>
				<%= with_new_lines @activity.description %>
			</div>
		</div>


		<% if !@user_activity.report.blank? %>

		<hr/>
		<div class="row">
			<div class="span9">
				<label><b>Report:</b></label>
				<%= with_new_lines @user_activity.report %>
			</div>
		</div>

		<% end %>


	</div>
	
</div>






<br/>
<hr/>
<br/>

<div class="row">


	<div class="span6 text-center">
		<% if !@user_activity.video_url.blank? %>
		<div>
			<label><b>Activity Video:</b></label>
		</div>
		<div class="video-container">
			<label><b>User Activty Video:</b></label>
			<% if @user_activity.video_url %>
				<% if @user_activity.video_url.include?('youtube') or @user_activity.video_url.include?('youtu.be') %>
					<%= auto_html(@user_activity.video_url) { youtube } %>
				<% elsif @user_activity.video_url.include? 'vimeo' %>
					<%= auto_html(@user_activity.video_url) { vimeo } %>
				<% else %>
					<%= auto_html(@user_activity.video_url) { simple_format; link(:target => 'blank') } %>
				<% end %>
			<% end %>
		</div>
		<% end %>
	</div>

	<div class="span6">
		<% if !@user_activity.user_activity_images.empty? %>
		<div>
			<div class="text-center">
			<label><b>User Pictures:</b></label>
			</div>
			
			<div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery">
				<ul class="wall" style="list-style-type: none; position:relative;">
				<% @user_activity.user_activity_images.each do |activity_image| %>
					<li class="item">
					<%= link_to image_tag(activity_image.image.url(:square), size: '175x175'), activity_image.image.url(:large), title: activity_image.image_file_name, 'data-gallery' => 'gallery' %>
					</li>
			 	<% end %>
			 	</ul>
			</div>
		</div>
		<% end %>
	</div>

</div>




<div id="modal-gallery" class="modal modal-gallery hide fade" tabindex="-1">
  <div class="modal-header">
      <a class="close" data-dismiss="modal">&times;</a>
      <h3 class="modal-title"></h3>
  </div>
  <div class="modal-body"><div class="modal-image"></div></div>
  <div class="modal-footer center">
		<a class="btn btn-info modal-prev"><i class="icon-arrow-left icon-white"></i> Previous</a>
    <a class="btn btn-info modal-next">Next <i class="icon-arrow-right icon-white"></i></a>      
  </div>
</div>

<script type="text/javascript">
	
	$(window).load(function() { 
		$('.wall').masonry( {
			"isFitWidth": true,
		  columnWidth: 175,
		  itemSelector: '.item'
		});
	});


	var processPrivacy = function(state){

		$.ajax({
	    type: 'POST',
	    url: '<%= user_activities_privacy_state_path(@user_activity) %>',
	    data: { 'state': state },
	    success: function(response){
	      console.log(response);
	    },
	    error: function(response){
				console.log(response);
	    }
	  });

	};


  $('#select_public').click(function(){
  	processPrivacy('<%= UserActivity::PUBLIC %>');
  });
  $('#select_only_me').click(function(){
  	processPrivacy('<%= UserActivity::ONLY_ME %>');
  });
  $('#select_friends').click(function(){
  	processPrivacy('<%= UserActivity::FRIENDS %>');
  });


</script>